<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.administracion.horariodetrabajo">

  <cache />
  
  
<select id="getNextCodigo" resultType="java.lang.String">
	select max(IdHorario) from HORARIO	
</select>
  

 
 <select id="getVerificaciondeCodigos"   parameterType="IngSoft.administracion.bean.HorarioDiaSemanaBeanData"   resultType="java.lang.String"   >
SELECT 
inf245g2.HORARIOxDIA_SEMANA.IdDiaSemana ,
    inf245g2.HORARIOxDIA_SEMANA.IdHorario
    FROM inf245g2.HORARIOxDIA_SEMANA
    WHERE
        inf245g2.HORARIOxDIA_SEMANA.IdDiaSemana=#{codigoDia}
    AND inf245g2.HORARIOxDIA_SEMANA.IdHorario=#{codigoHorario}

</select>

  
  
<select id="searchPlantillaHorariodetrabajo" parameterType="IngSoft.administracion.bean.CriterioHorariodetrabajoBeanData" resultType="IngSoft.administracion.bean.ResultadoHorariodetrabajoBeanData">


	

SELECT 
 inf245g2.HORARIO.IdHorario AS codigo
,inf245g2.HORARIO.Descripcion AS nombre
,group_concat(inf245g2.DIA_SEMANA.IdDiaSemana ORDER BY 1 ASC  ) AS codDiasemana
,group_concat(inf245g2.DIA_SEMANA.Nombre) AS diaSemana
,inf245g2.HORARIOxDIA_SEMANA.HoraInicio AS horaInicio
,inf245g2.HORARIOxDIA_SEMANA.HoraFin AS horaFin
,inf245g2.HORARIO.Estado AS estado
FROM
      inf245g2.HORARIO,  inf245g2.DIA_SEMANA, inf245g2.HORARIOxDIA_SEMANA
WHERE
		
	  inf245g2.HORARIO.IdHorario         = inf245g2.HORARIOxDIA_SEMANA.IdHorario 
AND   inf245g2.DIA_SEMANA.IdDiaSemana    = inf245g2.HORARIOxDIA_SEMANA.IdDiaSemana



AND inf245g2.HORARIO.IdHorario  like  #{nombre}
group by inf245g2.HORARIO.IdHorario

ORDER BY 1 ASC
;


</select>



<select id="getPLantillaHorariodetrabajo" parameterType="java.lang.String"  resultType="IngSoft.administracion.bean.HorariodetrabajoBeanData">


SELECT 
 inf245g2.HORARIO.IdHorario AS codigo
,inf245g2.HORARIO.Descripcion AS nombre
,group_concat(inf245g2.DIA_SEMANA.IdDiaSemana ORDER BY 1 ASC  ) AS codDiasemana
,group_concat(inf245g2.DIA_SEMANA.Nombre) AS diaSemana
,group_concat(inf245g2.HORARIOxDIA_SEMANA.HoraInicio) AS horaInicio
,group_concat(inf245g2.HORARIOxDIA_SEMANA.HoraFin) AS horaFin
,group_concat(inf245g2.HORARIOxDIA_SEMANA.Estado) AS estadosDias
,inf245g2.HORARIO.Estado AS estado

FROM
      inf245g2.HORARIO,  inf245g2.DIA_SEMANA, inf245g2.HORARIOxDIA_SEMANA
WHERE
		
	  inf245g2.HORARIO.IdHorario         = inf245g2.HORARIOxDIA_SEMANA.IdHorario 
AND   inf245g2.DIA_SEMANA.IdDiaSemana    = inf245g2.HORARIOxDIA_SEMANA.IdDiaSemana



AND   inf245g2.HORARIO.IdHorario  = #{codigo}
group by inf245g2.HORARIO.IdHorario

ORDER BY 1 ASC
;


</select>

<!-- Agregar plantilla Horario -->

<insert id="insertPlantillaHorariodetrabajo" parameterType="IngSoft.administracion.bean.HorariodetrabajoBeanData" flushCache="true">
	insert into HORARIO (IdHorario,Descripcion,Estado)
	values (#{codigo},#{nombre},#{estado})
</insert>



<!--Modificar Horario -->

<update id="modificarPlantillaHorariodetrabajo" parameterType="IngSoft.administracion.bean.HorariodetrabajoBeanData" >
update HORARIO 
set
IdHorario	=	#{codigo} ,
Descripcion	=	#{nombre} ,
estado	=	#{estado}

where IdHorario= #{codigo}
</update>
<!-- Fin  -->


<!-- Agregar plantilla Horarioxdiasemana -->

<insert id="insertPlantillaHorarioDiaSemana" parameterType="IngSoft.administracion.bean.HorarioDiaSemanaBeanData" flushCache="true">
	insert into HORARIOxDIA_SEMANA (IdDiaSemana,IdHorario,HoraInicio,HoraFin,Estado)
	values (#{codigoDia},#{codigoHorario},#{horaInicio},#{horaFin},#{estado})
</insert>


<!--Modificar Horarioxdiasemana -->

<update id="modificarPlantillaHorarioDiaSemana" parameterType="IngSoft.administracion.bean.HorarioDiaSemanaBeanData" >
update HORARIOxDIA_SEMANA 
set
IdDiaSemana	=	#{codigoDia} ,
IdHorario	=	#{codigoHorario} ,
HoraInicio	=	#{horaInicio},
HoraFin	=	#{horaFin},
Estado =   #{estado}

where IdDiaSemana = #{codigoDia}
AND	  IdHorario   = #{codigoHorario}
</update>
<!-- Fin eliminar -->




<!--Eliminar  -->

<update id="deletePLantillaActividad" parameterType="java.lang.String" >
update inf245g2.HORARIO set Estado ='No Activado' where IdActividad = #{codigo}
</update>
<!-- Fin eliminar -->



<!--obtener los dias de la semana -->
<select id="getDias" parameterType="java.lang.String" resultType="IngSoft.administracion.bean.DiasBeanData">
select 
  inf245g2.DIA_SEMANA.IdDiaSemana as codigo
, inf245g2.DIA_SEMANA.Nombre as nombre
from 
DIA_SEMANA
 
</select>




</mapper>