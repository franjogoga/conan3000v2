<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.administracion.reserva">

  <cache />
  
  
<select id="getNextInvitadoSocio" resultType="java.lang.String">
	select max(IdInvitadoSocio) from inf245g2.INVITADOxSOCIO	
</select>


<select id="searchPlantillaReservaInvitadoxSocio" parameterType="IngSoft.administracion.bean.CriterioReservaBeanData" resultType="IngSoft.administracion.bean.ResultadoReservaBeanData">



SELECT 
inf245g2.INVITADOxSOCIO.IdInvitadoSocio AS codigo,
inf245g2.INVITADOxSOCIO.IdSocio AS codigosocio,
					SOC.Nombres AS nombresocio,
					SOC.ApePaterno AS apaternosocio,
					SOC.ApeMaterno AS amaternosocio,


inf245g2.INVITADO.IdInvitado AS codigoinvitado,
inf245g2.PERSONA.Nombres AS nombre,
inf245g2.PERSONA.ApePaterno AS apaterno,
inf245g2.PERSONA.ApeMaterno AS amaterno,
inf245g2.PERSONA.NumeroDocumento AS dni,
inf245g2.INVITADOxSOCIO.FechaIngreso AS fechaingreso,
inf245g2.INVITADOxSOCIO.Estado AS estado
FROM  (inf245g2.INVITADO , inf245g2.PERSONA ) 
LEFT JOIN  inf245g2.INVITADOxSOCIO  
ON inf245g2.INVITADOxSOCIO.IdInvitado = inf245g2.INVITADO.IdInvitado 

LEFT JOIN  inf245g2.PERSONA SOC
ON inf245g2.INVITADOxSOCIO.IdSocio = SOC.IdPersona

WHERE
    inf245g2.INVITADO.IdInvitado = inf245g2.PERSONA.IdPersona 
AND   inf245g2.PERSONA.Nombres LIKE #{nombre}
;


</select>




<select id="getPLantillaReserva" parameterType="java.lang.String"  resultType="IngSoft.administracion.bean.ReservaBeanData">
SELECT 
inf245g2.INVITADOxSOCIO.IdInvitadoSocio AS codigo,
inf245g2.INVITADOxSOCIO.IdSocio AS codigosocio,
inf245g2.INVITADO.IdInvitado AS codigoinvitado,
inf245g2.PERSONA.Nombres AS nombre,
inf245g2.PERSONA.ApePaterno AS apaterno,
inf245g2.PERSONA.ApeMaterno AS amaterno,
inf245g2.PERSONA.NumeroDocumento AS dni,
inf245g2.INVITADOxSOCIO.FechaIngreso AS fechaingreso,
inf245g2.INVITADOxSOCIO.Monto AS monto,
inf245g2.INVITADOxSOCIO.Estado AS estado



FROM  (inf245g2.INVITADO , inf245g2.PERSONA)     LEFT JOIN  inf245g2.INVITADOxSOCIO  

    
ON inf245g2.INVITADOxSOCIO.IdInvitado = inf245g2.INVITADO.IdInvitado
WHERE
   inf245g2.INVITADO.IdInvitado = inf245g2.PERSONA.IdPersona
AND inf245g2.INVITADOxSOCIO.IdInvitadoSocio = #{codigo}

</select>


<select id="getPLantillaReservaInvitado" parameterType="java.lang.String"  resultType="IngSoft.administracion.bean.ReservaBeanData">
SELECT 
inf245g2.INVITADOxSOCIO.IdInvitadoSocio AS codigo,
inf245g2.INVITADOxSOCIO.IdSocio AS codigosocio,
inf245g2.INVITADO.IdInvitado AS codigoinvitado,
inf245g2.PERSONA.Nombres AS nombre,
inf245g2.PERSONA.ApePaterno AS apaterno,
inf245g2.PERSONA.ApeMaterno AS amaterno,
inf245g2.PERSONA.NumeroDocumento AS dni,
inf245g2.INVITADOxSOCIO.FechaIngreso AS fechaingreso,
inf245g2.INVITADOxSOCIO.Monto AS monto,
inf245g2.INVITADOxSOCIO.Estado AS estado



FROM  (inf245g2.INVITADO , inf245g2.PERSONA)     LEFT JOIN  inf245g2.INVITADOxSOCIO  

    
ON inf245g2.INVITADOxSOCIO.IdInvitado = inf245g2.INVITADO.IdInvitado
WHERE
   inf245g2.INVITADO.IdInvitado = inf245g2.PERSONA.IdPersona
AND inf245g2.INVITADO.IdInvitado = #{codigo}

</select>




<select id="getAllpersonas"  resultType="IngSoft.administracion.bean.PersonaBeanData">
SELECT 
inf245g2.PERSONA.IdPersona AS codigo,
inf245g2.PERSONA.Nombres   AS  nombre,
inf245g2.PERSONA.ApePaterno AS apaterno,
inf245g2.PERSONA.ApeMaterno AS amaterno

FROM inf245g2.PERSONA;
</select>

<!-- Agregar plantilla  -->

<insert id="insertPlantillaReserva" parameterType="IngSoft.administracion.bean.ReservaBeanData" flushCache="true">
INSERT INTO `inf245g2`.`INVITADOxSOCIO` (`IdInvitadoSocio`, `IdSocio`, `IdInvitado`, `FechaIngreso`, `Monto`, `Estado`) 
                                 VALUES (#{codigo}, #{codigosocio}, #{codigoinvitado} , #{fechaingreso} , #{monto}, #{estado});
	
</insert>




<!--Modificar invitado -->

<update id="modificarPlantillaReserva" parameterType="IngSoft.administracion.bean.ReservaBeanData" >


UPDATE

inf245g2.INVITADOxSOCIO

SET

inf245g2.INVITADOxSOCIO.FechaIngreso    =	#{fechaingreso} ,

inf245g2.INVITADOxSOCIO.Estado     =	#{estado}


WHERE inf245g2.INVITADOxSOCIO.IdInvitadoSocio = #{codigo}

;


</update>
<!-- Fin  Modificar -->

<!--Eliminar invitado -->

<update id="deletePLantillaReserva" parameterType="java.lang.String" >
update inf245g2.INVITADOxSOCIO 
set
 inf245g2.INVITADOxSOCIO.Estado ='Inactivo' 
WHERE inf245g2.INVITADOxSOCIO.IdInvitadoSocio = #{codigo}
</update>
<!-- Fin eliminar -->



</mapper>