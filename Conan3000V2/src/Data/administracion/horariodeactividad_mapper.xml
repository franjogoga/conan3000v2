<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.administracion.horariodeactividad">

  <cache />
  
  

  
  
  
 <select id="getVerificaciondeCodigosActividadxDia"   parameterType="IngSoft.administracion.bean.ActividadDiaSemanaBeanData"   resultType="java.lang.String"   >
SELECT 
    inf245g2.ACTIVIDADxDIA_SEMANA.IdDiaSemana ,
    inf245g2.ACTIVIDADxDIA_SEMANA.IdActividad
    FROM inf245g2.ACTIVIDADxDIA_SEMANA
    WHERE
        inf245g2.ACTIVIDADxDIA_SEMANA.IdDiaSemana=#{codigoDia}
    AND inf245g2.ACTIVIDADxDIA_SEMANA.IdActividad=#{codigoActividad}

</select>
  
  
<select id="searchPlantillaHorariodeactividad" parameterType="IngSoft.administracion.bean.CriterioHorariodeactividadBeanData" resultType="IngSoft.administracion.bean.ResultadoHorariodeactividadBeanData">


SELECT 
 inf245g2.ACTIVIDAD.IdActividad AS codigo
,inf245g2.ACTIVIDAD.Nombre AS nombre
,group_concat(inf245g2.DIA_SEMANA.IdDiaSemana) AS codDiasemana
,group_concat(inf245g2.DIA_SEMANA.Nombre) AS diaSemana
,inf245g2.ACTIVIDADxDIA_SEMANA.HoraInicio AS horaInicio
,inf245g2.ACTIVIDADxDIA_SEMANA.HoraFin AS horaFin
,inf245g2.ACTIVIDAD.Estado AS estado
FROM
      inf245g2.ACTIVIDAD,  inf245g2.DIA_SEMANA, inf245g2.ACTIVIDADxDIA_SEMANA
WHERE
		
	  inf245g2.ACTIVIDAD.IdActividad         = inf245g2.ACTIVIDADxDIA_SEMANA.IdActividad 
AND   inf245g2.DIA_SEMANA.IdDiaSemana    = inf245g2.ACTIVIDADxDIA_SEMANA.IdDiaSemana
AND    inf245g2.ACTIVIDAD.Nombre  like  #{nombre} 




group by inf245g2.ACTIVIDAD.IdActividad
;


</select>


<select id="getPLantillaHorariodeactividad" parameterType="java.lang.String"  resultType="IngSoft.administracion.bean.HorariodeactividadBeanData">


SELECT 
 inf245g2.ACTIVIDAD.IdActividad AS codigo
,inf245g2.ACTIVIDAD.Nombre AS nombre
,group_concat(inf245g2.DIA_SEMANA.IdDiaSemana) AS codDiasemana
,group_concat(inf245g2.DIA_SEMANA.Nombre) AS diaSemana
,group_concat(inf245g2.ACTIVIDADxDIA_SEMANA.HoraInicio) AS horaInicio
,group_concat(inf245g2.ACTIVIDADxDIA_SEMANA.HoraFin) AS horaFin
,group_concat(inf245g2.ACTIVIDADxDIA_SEMANA.Estado) AS estadosDias
,inf245g2.ACTIVIDAD.Estado AS estado

FROM
      inf245g2.ACTIVIDAD,  inf245g2.DIA_SEMANA, inf245g2.ACTIVIDADxDIA_SEMANA
WHERE
		
	  inf245g2.ACTIVIDAD.IdActividad     = inf245g2.ACTIVIDADxDIA_SEMANA.IdActividad 
AND   inf245g2.DIA_SEMANA.IdDiaSemana    = inf245g2.ACTIVIDADxDIA_SEMANA.IdDiaSemana




AND   inf245g2.ACTIVIDAD.IdActividad  = #{codigo}
group by inf245g2.ACTIVIDAD.IdActividad

ORDER BY 1 ASC


</select>

<!--Modificar  -->

<update id="modificarPlantillaHorariodeactividad" parameterType="IngSoft.administracion.bean.HorariodeactividadBeanData" >
update ACTIVIDAD 
set
estado	=	#{estado}
where IdActividad= #{codigo}
</update>
<!-- Fin  -->

<!--Eliminar  -->

<update id="deletePLantillaHorariodeactividad" parameterType="java.lang.String" >
update inf245g2.ACTIVIDAD set Estado ='No Disponible' where  inf245g2.ACTIVIDAD.IdActividad = #{codigo}
</update>
<!-- Fin eliminar -->



<!-- Agregar plantilla ACTIVIDADxDIA_SEMANA -->

<insert id="insertPlantillaActividadDiaSemana" parameterType="IngSoft.administracion.bean.ActividadDiaSemanaBeanData" flushCache="true">
	insert into inf245g2.ACTIVIDADxDIA_SEMANA (IdDiaSemana,IdActividad,HoraInicio,HoraFin,Duracion,Estado,Horario)
	values (#{codigoDia},#{codigoActividad},#{horaInicio},#{horaFin},#{duracion},#{estado},#{horario})
</insert>


<!--Modificar Horarioxdiasemana -->

<update id="modificarPlantillaActividadDiaSemana" parameterType="IngSoft.administracion.bean.ActividadDiaSemanaBeanData" >
update ACTIVIDADxDIA_SEMANA 
set
IdDiaSemana	=	#{codigoDia} ,
IdActividad	=	#{codigoActividad} ,
HoraInicio	=	#{horaInicio},
HoraFin	    =	#{horaFin},
Duracion	=	#{duracion},
Estado      =   #{estado}

where IdDiaSemana   = #{codigoDia}
AND	  IdActividad   = #{codigoActividad}
</update>
<!-- Fin eliminar -->



<!--obtener los dias de la semana -->
<select id="getDias" parameterType="java.lang.String" resultType="IngSoft.administracion.bean.DiasBeanData">
select 
  inf245g2.DIA_SEMANA.IdDiaSemana as codigo
, inf245g2.DIA_SEMANA.Nombre as nombre
from 
DIA_SEMANA
 
</select>

<!--obtener todas las actividades -->
<select id="getAllActividades" parameterType="java.lang.String" resultType="IngSoft.administracion.bean.ResultadoActividadBeanData">



SELECT 
inf245g2.ACTIVIDAD.IdActividad AS codigo ,
inf245g2.ACTIVIDAD.nombre as nombre,
inf245g2.TIPO_ACTIVIDAD.nombre as tipoactividad,
inf245g2.ACTIVIDAD.estado as estado


FROM inf245g2.ACTIVIDAD , inf245g2.TIPO_ACTIVIDAD 


WHERE

inf245g2.ACTIVIDAD.IdTipoActividad = inf245g2.TIPO_ACTIVIDAD.IdTipoActividad

ORDER BY 1 ASC
;


</select>


</mapper>