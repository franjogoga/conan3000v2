<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.administracion.actividad">

  <cache />
  
  
<select id="getNextCodigo" resultType="java.lang.String">
	select max(IdSede) from SEDE	
</select>
  
<select id="searchPlantillaActividad" parameterType="IngSoft.administracion.bean.CriterioActividadBeanData" resultType="IngSoft.administracion.bean.ResultadoActividadBeanData">



SELECT 
ACTIVIDAD.IdActividad AS codigo,
ACTIVIDAD.nombre as nombre,
TIPO_ACTIVIDAD.nombre as tipoactividad,
ACTIVIDAD.estado as estado
FROM
TIPO_ACTIVIDAD , ACTIVIDAD ,  AMBIENTE ,   
SEDE ,            EMPLEADO ,   PERSONA 


WHERE

    ACTIVIDAD.IdSede    = AMBIENTE.IdSede 
AND AMBIENTE.IdSede     = SEDE.IdSede 
AND SEDE.IdSede         = EMPLEADO.IdSede 
AND EMPLEADO.IdEmpleado = PERSONA.IdPersona 

AND ACTIVIDAD.IdEmpleado =  EMPLEADO.IdEmpleado
AND ACTIVIDAD.IdTipoActividad = TIPO_ACTIVIDAD.IdTipoActividad 
AND ACTIVIDAD.IdAmbiente =  AMBIENTE.IdAmbiente

ORDER BY 1 ASC
;


</select>


<select id="getPLantillaActividad" parameterType="java.lang.String"  resultType="IngSoft.administracion.bean.ActividadBeanData">





SELECT 
inf245g2.ACTIVIDAD.IdActividad AS codigo,
inf245g2.SEDE.nombre AS nombreSede,
inf245g2.ACTIVIDAD.nombre as nombre,
inf245g2.TIPO_ACTIVIDAD.nombre as nombreTipoactividad,
inf245g2.PERSONA.Nombres as nombreEncargado,
inf245g2.EMPLEADO.Puesto as puesto,
inf245g2.AMBIENTE.Nombre as nombreAmbientes,
inf245g2.ACTIVIDAD.FechaInicio AS fechaInicio,
inf245g2.ACTIVIDAD.FechaFin AS fechaFin,
inf245g2.ACTIVIDAD.Descripcion AS descripcion,
inf245g2.ACTIVIDAD.Estado AS estado
FROM
inf245g2.TIPO_ACTIVIDAD , inf245g2.ACTIVIDAD ,  inf245g2.AMBIENTE ,   
inf245g2.SEDE ,            inf245g2.EMPLEADO ,   inf245g2.PERSONA 


WHERE
    inf245g2.ACTIVIDAD.IdActividad    = #{codigo}
AND inf245g2.ACTIVIDAD.IdSede    = inf245g2.AMBIENTE.IdSede 
AND inf245g2.AMBIENTE.IdSede     = inf245g2.SEDE.IdSede 
AND inf245g2.SEDE.IdSede         = inf245g2.EMPLEADO.IdSede 
AND inf245g2.EMPLEADO.IdEmpleado = inf245g2.PERSONA.IdPersona 

AND inf245g2.ACTIVIDAD.IdEmpleado =  inf245g2.EMPLEADO.IdEmpleado
AND inf245g2.ACTIVIDAD.IdTipoActividad = inf245g2.TIPO_ACTIVIDAD.IdTipoActividad 
AND inf245g2.ACTIVIDAD.IdAmbiente =  inf245g2.AMBIENTE.IdAmbiente

ORDER BY 1 ASC


</select>




<!--Modificar sede -->

<update id="modificarPlantillaActividad" parameterType="IngSoft.administracion.bean.ActividadBeanData" >
update ACTIVIDAD 
set
IdSede	=	#{nombreSede} ,
Nombre	=	#{nombre} ,
IdEmpleado	=	#{nombreEncargado} ,
IdAmbiente	=	#{nombreAmbientes} ,
FechaInicio	=	#{fechaInicio} ,
FechaFin	=	#{fechaFin} ,
Descripcion	=	#{descripcion} ,
IdTipoActividad	=	#{nombreTipoactividad}

where IdActividad= #{codigo}
</update>
<!-- Fin eliminar -->

<!--Eliminar sede -->

<update id="deletePLantillaActividad" parameterType="java.lang.String" >
update ACTIVIDAD set Estado ='No Disponible' where IdActividad = #{codigo}
</update>
<!-- Fin eliminar -->




<!-- tipoactividad  -->
<select id="getTipoactividad" resultType="IngSoft.administracion.bean.TipoActividadMiniBeanData">
select TIPO_ACTIVIDAD.IdTipoActividad as codigo
, TIPO_ACTIVIDAD.Nombre as nombre
from 
TIPO_ACTIVIDAD; 

</select>


<!-- sedes  -->
<select id="getSede" resultType="IngSoft.administracion.bean.SedeBeanData">
select SEDE.IdSede as codigo
, SEDE.Nombre as nombre
from 
SEDE; 

</select>

<!-- ambientes  -->
<select id="getAmbiente" resultType="IngSoft.administracion.bean.AmbienteBeanData">
select AMBIENTE.IdAmbiente as codigo
, AMBIENTE.Nombre as nombre
from 
AMBIENTE; 

</select>

</mapper>