<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.administracion.empleado">

  <cache />

<select id="searchHorarios" resultType="IngSoft.administracion.bean.HorarioEmpleados">
	select IdHorario as codigo
	,Descripcion 
	from 
	HORARIO
	order by 1
	
</select>

<update id="updatePlantillaEmpleado" parameterType="IngSoft.administracion.bean.EmpleadoBeanData">
update EMPLEADO set EMPLEADO.Area =#{area}
where  IdEmpleado= #{codigo};
</update>

<update id="updatePlantillaPersona" parameterType="IngSoft.administracion.bean.EmpleadoBeanData">
update PERSONA set PERSONA.Nombres =#{nombre}
 ,PERSONA.ApePaterno=#{apellidoPaterno}
 ,PERSONA.NumeroDocumento= #{numeroDocumento} 
where  IdPersona= #{codigo};
</update>





<select id="searchPlantillaEmpleado" parameterType="IngSoft.administracion.bean.CriterioEmpleadoBeanData" resultType="IngSoft.administracion.bean.ResultadoEmpleadoBeanData">
select 
 EMPLEADO.IdEmpleado as codigo
,PERSONA.Nombres as nombre
<!-- Cambio David: apellidoPaterno por aPaterno -->
,PERSONA.apePaterno as aPaterno
<!-- Fin cambios -->
,PERSONA.NumeroDocumento as numeroDocumento
,EMPLEADO.Area as area
from EMPLEADO, PERSONA 


<where>
<if test="nombre != null ">
        PERSONA.Nombres  like  #{nombre}
    </if>
    
    <if test="apellidoPaterno != null ">
        AND PERSONA.ApePaterno like #{apellidoPaterno}
    </if>
    
    <if test="numeroDocumento > null">
        AND PERSONA.NumeroDocumento = #{numeroDocumento}
    </if>
    
    <if test="area != null">
        AND EMPLEADO.Area like #{area}
    </if>
    AND EMPLEADO.Estado='activo' AND EMPLEADO.IdEmpleado = PERSONA.IdPersona
</where>

order by 1 asc
</select>





<select id="getNextCodigo" resultType="java.lang.String">
	select max(IdEmpleado) from EMPLEADO	
</select>

<insert id="insertPlantillaEmpleado" parameterType="IngSoft.administracion.bean.EmpleadoBeanData"
	flushCache="true">
	insert into
	EMPLEADO(IdSede,IdEmpleado,IdHorario,fechaContrato,Puesto,Area,Estado,CodigoEmpleado)
	values (#{idSede},#{codigo},#{idHorario},#{fechaContrato},#{puesto},#{area},#{estado},#{codigo})
</insert>



<insert id="insertPlantillaPersona" parameterType="IngSoft.administracion.bean.EmpleadoBeanData"
	flushCache="true">
	insert into
	PERSONA(IdPersona,Nombres,apePaterno,apeMaterno,NumeroDocumento,fechaNac,TipoDocumento)
	values (#{codigo},#{nombre},#{apellidoPaterno},#{apellidoMaterno},#{numeroDocumento},#{fechaNacimiento},#{tipoDocumento})
</insert>



<update id="deletePlantillaEmpleado" parameterType="java.lang.String" >
update EMPLEADO set Estado='inactivo' where IdEmpleado= #{codigo}
</update>


<select id="getPlantillaEmpleado" parameterType="String" resultType="IngSoft.administracion.bean.EmpleadoBeanData">


select 
IdEmpleado as codigo,
Nombres as nombre,
apePaterno as apellidoPaterno,
NumeroDocumento as numeroDocumento,
Area as area
from EMPLEADO e, PERSONA p  where e.IdEmpleado = #{codigo} AND p.IdPersona = #{codigo} ;


 
</select>



</mapper>