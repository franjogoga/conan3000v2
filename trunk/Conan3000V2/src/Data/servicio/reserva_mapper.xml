<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Data.servicio.reserva">

  <cache />

<select id="searchBungalowxSede" parameterType="java.lang.String" resultType="IngSoft.servicio.bean.BungalowMiniBeanData">
select r1.codigoBungalow
,r1.nombreBungalow
,r2.codigoSocio
,r2.Fecha
from
(select b.IdBungalow as codigoBungalow
,b.Numero as nombreBungalow
,a.IdSede as codigoSede
from 
BUNGALOW b 
left join 
AMBIENTE a 
on a.IdAmbiente=b.IdAmbiente
where 
b.Estado ="ACTIVO") r1 
left join
(select rb.IdBungalow as codigoBungalow
,rb.IdReservaBungalow as codigoReserva
,rb.IdSocio  as codigoSocio
,bf.Fecha as Fecha
from 
RESERVA_BUNGALOW rb,
BUNGALOWxFECHA bf 
where bf.IdReservaBungalow=rb.IdReservaBungalow) r2
on r1.codigoBungalow=r2.codigoBungalow
where r1.codigoSede like #{codigo}
order by 2 asc;
</select>

</mapper>